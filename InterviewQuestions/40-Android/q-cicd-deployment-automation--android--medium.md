---
id: 20251012-122797
title: CI/CD Deployment Automation / Автоматизация деплоя в CI/CD
aliases:
- CI/CD Deployment Automation
- Автоматизация деплоя в CI/CD
topic: android
subtopics:
- gradle
- play-console
question_kind: android
difficulty: medium
original_language: en
language_tags:
- en
- ru
status: reviewed
moc: moc-android
related:
- q-build-optimization-gradle--android--medium
- q-android-lint-tool--android--medium
- q-app-store-optimization--android--medium
created: 2025-10-15
updated: 2025-10-20
tags:
- android/gradle
- android/play-console
- difficulty/medium
name: Deploy
true:
- workflow_dispatch
jobs: null
---

# Вопрос (RU)
> Автоматизация деплоя в CI/CD?

# Question (EN)
> CI/CD Deployment Automation?

---

## Ответ (RU)

(Требуется перевод из английской секции)

## Answer (EN)

### Goals
- Reproducible signed builds; traceable versions
- Safe, staged rollout with fast rollback
- Auditable artifacts and release notes

### Release pipeline (high level)
- Build → Sign → Scan (lint/tests) → Upload (internal) → Gates → Promote (alpha/beta/production) → Monitor → Rollback

### Versioning
- Single source of truth (Gradle): auto‑bump on main; embed git SHA/date.
- Semantic or monotonic `versionCode`; auto‑generate `versionName`.

### Signing
- Use Play App Signing; keep upload keystore in CI secrets (OIDC/secret store) with [[c-encryption]].
- Sign via Gradle `signingConfig` with injected env secrets; never commit keystores to maintain [[c-secure-storage]].

### Artifacts
- Produce AAB (primary) and APK (for internal testing) + mapping.txt + ProGuard/R8 reports.
- Upload artifacts to CI (artifacts) and Play internal track.

### Distribution
- Internal track for PR merges; alpha/beta for staged users; promote on SLOs/metrics.
- Release notes autogenerated from conventional commits/CHANGELOG.

### Minimal CI deploy step (GitHub Actions)
```yaml
name: Deploy
on: [workflow_dispatch]
jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with: { distribution: temurin, java-version: '17' }
      - uses: gradle/gradle-build-action@v2
      - name: Build release AAB
        run: ./gradlew :app:bundleRelease --configuration-cache --build-cache
      - name: Upload to Play (internal)
        env:
          JSON_KEY: ${{ secrets.PLAY_SERVICE_ACCOUNT_JSON }}
        run: |
          echo "$JSON_KEY" > sa.json
          ./gradlew publishBundle --no-daemon -Pandroid.injected.signing.store.file=$SIGN_STORE \
            -Pandroid.injected.signing.store.password=$SIGN_PASS \
            -Pandroid.injected.signing.key.alias=$SIGN_ALIAS \
            -Pandroid.injected.signing.key.password=$KEY_PASS \
            -Pplay.service.account.json=sa.json -Pplay.track=internal
```

### Gates and rollout
- Gates: test pass, lint clean, min coverage, crash‑free sessions threshold in internal.
- Staged rollout (e.g., 5% → 20% → 50% → 100%); auto‑promote if metrics OK.

### Rollback
- Keep last stable artifact + mapping; Play console supports halt and roll back by previous release.
- Automate “halt + promote previous build” command.

### Observability
- Release dashboard: build SHA, version, track, rollout %, crash rate, ANR, key KPIs.

## Follow-ups
- How to secure signing keys and Play service accounts in CI?
- How to design staged rollout policies and auto‑promote rules?
- How to implement release notes and changelog automation?

## References
- https://developer.android.com/studio/publish
- https://docs.gradle.org/current/userguide/build_cache.html
- https://github.com/Triple-T/gradle-play-publisher

## Related Questions

### Prerequisites (Easier)
- [[q-build-optimization-gradle--android--medium]]

### Related (Same Level)
- [[q-android-lint-tool--android--medium]]
- [[q-cicd-automated-testing--android--medium]]

### Advanced (Harder)
- [[q-app-store-optimization--android--medium]]
